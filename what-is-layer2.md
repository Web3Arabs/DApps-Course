# ما هي سلاسل كتل blockchain من الطبقة الثانية (Layer 2)؟

"بلوكشين لا تتوسع." ربما سمعت هذا عدة مرات. قبل عامين وشعرت وكأنها تهديد حقيقي لهذه الصناعة. كيف يمكننا التعامل مع غير المتعاملين مع البنوك إذا لم نتمكن حتى من معالجة 15 معاملة في الثانية؟

لكن المشاكل الكبيرة تغذي الابتكار. وكانت قابلية تطوير blockchain مشكلة كبيرة. سرعان ما لفتت انتباه المهندسين والعلماء، وبسرعة إلى يومنا هذا، تزداد ثقتنا بإمكانية توسيع blockchain. في الواقع، يتعلق معظم النقاش الحالي بأي حل قابلية للتوسع سيفوز.

لهذا السبب، سنقوم بتفصيل بعض حلول قابلية التوسع في Ethereum التي تم استكشافها في السنوات الخمس الماضية - وأشرح كيف كان كل منها نقطة انطلاق لما قد يكون الفائز التراكمية.

## مواجهة “Scalability Trilemma”

لا يمكننا التحدث عن قابلية التوسع دون ذكر "قابلية التوسع ثلاثية الأبعاد" الشهيرة. <a href="https://vitalik.ca/general/2021/04/07/sharding.html" target="_blank">صاغ Vitalik</a> المصطلح لشرح الخصائص الثلاث التي تهدف إلى امتلاكها blockchain: قابلية التوسع واللامركزية والأمان. من الواضح، حتى الآن أنه يمكننا تحقيق اثنتين من هذه الخصائص. لكن الحصول على الثلاثة أمر صعب حقًا.

قبل أن نفهم السبب، دعنا نصحح شروطنا.

1- قابلية التوسع تعني فقط أن blockchain يمكنه معالجة الكثير من المعاملات، يتم قياسها بالمعاملات في الثانية (TPS).

2- اللامركزية تعني أن blockchain يتم تشغيله بواسطة العديد من العقد "غير الموثوقة" في جميع أنحاء العالم - ولا يتم تشغيلها بواسطة مجموعة صغيرة من العقد المركزية "الموثوقة".

3- حماية تعني أن blockchain مقاوم للهجوم حتى لو كانت نسبة معينة من العقد في الشبكة ضارة. من الناحية المثالية، يجب أن يكون قادرًا على التعامل مع ما يصل إلى 50٪ من العقد الضارة.

أنشأ Vitalik مثلثًا بسيطًا حيث تمثل كل حافة إحدى الخصائص الثلاث. يمثل كل جانب من جوانب المثلث الأنواع المختلفة من حلول blockchain القادرة على تحقيق 2 من الخصائص الثلاث.

<img src="https://www.web3arabs.com/courses/layers/vitalik-represented.png" alt="Vitalik Represented"/>

### لامركزية وآمن

في الجزء السفلي من المثلث توجد سلاسل الكتل التقليدية مثل Bitcoin و Ethereum 1.0.
<img src="https://www.web3arabs.com/courses/layers/decentralized-secure.png" alt="Decentralized Secure"/>

هذه الأنواع من blockchain هي:

- **لامركزية**: نعم. لأنه يمكن لأي شخص في العالم أن يختار أن يصبح عقدة تعدين. هناك الآلاف من عمال المناجم حول العالم يشاركون في تأمين شبكات Bitcoin و Ethereum. ليست هناك حاجة أيضًا لترخيص نفسك كعامل منجم؛ إنه غير موثوق به تمامًا.
- **آمن**: نعم. لأن كل عقدة في الشبكة تحتفظ بنسخة من blockchain وتتحقق من كل معاملة. علاوة على ذلك ، تم تصميم Proof-of-Work للتعامل مع ما يصل إلى 50٪ من العقد ضارة.
- **قابلة للتطوير**: لا. بحكم أمانها، تحتفظ كل عقدة في الشبكة بنسخة من blockchain وتتحقق من كل معاملة. في حين أن هذا آمن، إلا أنه غير فعال ، مما يجعل وقت الاستجابة والإنتاجية منخفضة للغاية. بالنسبة إلى Bitcoin، فهي عبارة عن 7 معاملات في الثانية، وبالنسبة إلى Ethereum، فهي عبارة عن حوالي 15 معاملة في الثانية.

### آمن وقابل للتطوير

على الجانب الأيمن من المثلث توجد سلاسل TPS عالية نموذجية، مثل سلسلة Binance الذكية. يستخدمون خوارزمية إجماع تسمى " ثبات سلطة الرهان"، حيث يتم "انتخاب" 21 عقدة لإنتاج كتل جديدة. كل 24 ساعة، يتم اختيار مجموعة جديدة من 21 عقدة لإنتاج كتل جديدة لمدة 24 ساعة.

<img src="https://www.web3arabs.com/courses/layers/secure-scalable.png" alt="Secure Scalable"/>

- **آمن**: نعم. كل عقدة "منتخبة" مرخصة، لذلك لدينا سيطرة على الخصوم في النظام.‍
- **قابلة للتطوير**: نعم. نظرًا لأن عددًا قليلاً من العقد المنتخبة ينتج كتلًا جديدة في أي وقت، فيمكننا الحصول على معدل نقل أعلى للمعاملات وزمن انتقال. هذا يعني أن هناك عبء اتصال أقل مما لو كان يتعين على كل عقدة التحقق من صحة كل معاملة.‍
- **لامركزية**: لا. نظرًا لوجود 21 مدققًا منتخبًا فقط، فهي طريقة أقل لامركزية من سلاسل الكتل التقليدية. علاوة على ذلك، كل عقدة "منتخبة" مرخصة، لذلك نحن نقدم الثقة في النظام، مما يجعله أقل لامركزية.

### قابلة للتطوير ولامركزية

على الجانب الأيسر من المثلث توجد أنظمة بيئية متعددة السلاسل، مثل Cosmos و Polkadot و Avalanche. تحتوي هذه الأنظمة على العديد من شبكات blockchain المستقلة التي تتواصل جميعها كجزء من شبكة blockchain الأكبر.

<img src="https://www.web3arabs.com/courses/layers/scalable-decentralized.png" alt="Scalable Decentralized"/>

- **قابلة للتطوير**: نعم. نظرًا لأننا لم نعد مطالبين بتخزين الحالة بالكامل على blockchain واحد، يمكننا تقسيم الحالة عبر العديد من سلاسل blockchain المستقلة، مما يحقق قابلية توسع أعلى من blockchain التقليدي.
- **اللامركزية**: يعتمد. يحتوي كل blockchain في النظام البيئي على مجموعة من العقد التي تتحقق من صحة blockchain. تحتوي بعض السلاسل في النظام البيئي على العديد من أدوات التحقق (مثل سلسلة العملات المستقرة التي يجب أن تكون لامركزية)، بينما قد يكون لدى البعض الآخر عدد قليل جدًا أو حتى واحد فقط (مثل سلسلة المؤسسات، التي لا تحتاج إلى الكثير من اللامركزية). لذا، يعتمد مستوى اللامركزية على أي سلسلة في النظام البيئي نشير إليها.
- **آمن**: ليس حقًا. إذا كانت هناك سلسلة في النظام البيئي تتعرض للهجوم، فقد يكون لها تأثيرات مضاعفة على بقية النظام. على سبيل المثال، إذا تعرضت السلسلة B للهجوم واعتمدت السلسلة A و C و D عليها، فستتأثر تلك السلاسل الأخرى أيضًا.

كما ترى، كانت هناك العديد من المحاولات المختلفة لتوسيع نطاق البلوكشين ، ولكنها تأتي دائمًا على حساب إحدى هذه الخصائص الثلاثة. لم يكن Vitalik ومجتمع Ethereum مستعدين لتقديم هذا الحل الوسط. هدفهم هو الحصول على الثلاثة.

قبل أن ندخل في كيفية تحقيق ذلك، من المهم أن نفهم شيئًا آخر: مقياس Layer 1 مقابل مقياس Layer 2.

## فهم مقياس Layer 1 & 2

في أعلى مستوى، يشير مقياس الطبقة 1 إلى توسيع نطاق blockchain الأساسي نفسه. في المقابل، يشير مقياس الطبقة 2 إلى نقل المعاملات من طبقة blockchain الرئيسية إلى طبقة منفصلة يمكنها التواصل مع mainchain.

<img src="https://www.web3arabs.com/courses/layers/layers-scaling1.png" alt="Layers Scaling 1"/>

تأمل Ethereum في استخدام حلول الطبقة 1 والطبقة 2 لحل قابلية التوسع trilemma. التقاسم هو حل الطبقة 1 من Ethereum، في حين أن Rollups هي حل الطبقة 2 من Ethereum.

<img src="https://www.web3arabs.com/courses/layers/layers-scaling2.png" alt="Layers Scaling 2"/>

## أقدم حلول الطبقة الثانية من Ethereum

ولكن يجب أن تنتظر عمليات التجميع والتجزئة للحظة واحدة فقط. أولاً، يجب أن نؤرخ حلول قياس الطبقة الثانية التي اكتشفها Ethereum في الماضي قبل أن نصل أخيرًا إلى التجميعات، "الكأس المقدسة" لـ Ethereum. بعد كل شيء، هذه هي الطريقة التي تعمل بها الهندسة - نأتي بأفكار ونختبرها ونكررها حتى نجد حلاً ناجحًا.

### قنوات الدولة “State Channels”

كانت القنوات الحكومية موجودة منذ <a href="https://www.jeffcoleman.ca/state-channels/" target="_blank">وقت طويل</a>، لذا فهي ليست جديدة. فيما يلي توضيح سريع لكيفية عملها. لنفترض أن لدينا شخصين، أليس وبوب، يريدان التعامل مع بعضهما البعض. ستدفع أليس لبوب دولارًا واحدًا في كل مرة يغرد فيها. ولكن نظرًا لأن Bob يغرد كثيرًا كل يوم، فإن استخدام Ethereum للمعاملات سيكون بطيئًا للغاية ومكلفًا للغاية.

بدلاً من ذلك، يستخدمون "State Channels:

- تضع أليس 500 دولار في عقد ذكي على Ethereum.
- عندما تريد أليس إرسال دولار واحد إلى بوب، فإنها توقع رسالة تشير إلى المبلغ الذي تريد إرساله إلى بوب. تستمر في توقيع الرسائل حتى يصبح بوب مستعدًا "لسحب" أمواله.
- يرسل بوب رسالة جديدة تشير إلى أنه مستعد لإغلاق قناة الدولة. يتحقق العقد الذكي على Ethereum من توقيعات Alice و Bob، ويدفع لـ Bob المبلغ المستحق، ويعيد الباقي إلى Alice.

<img src="https://www.web3arabs.com/courses/layers/state-channels.png" alt="State Channels"/>

لاحظ كيف أن الخطوات الأولى والأخيرة فقط تتطلب منا التعامل على blockchain. بين هذه الخطوات، يمكن لأليس وبوب إرسال عدد غير محدود من الرسائل الموقعة لبعضهما البعض للإشارة إلى الدفع.

في هذه الحالة، يتم استخدام سلسلة Ethereum blockchain فقط كطبقة تسوية لمعالجة المعاملة النهائية بدفع دفعة واحدة. هذا يرفع العبء عن blockchain الأساسي.

**هذه هي النقطة الأساسية**: من خلال فتح قناة للمعاملات خارج blockchain، فإننا نزيد بشكل كبير من سعة وسرعة المعاملات مع الحفاظ على انخفاض التكاليف. هذا ممكن بسبب:

- أولاً، تتم غالبية المعاملات خارج السلسلة. هذا يعني أنه يمكن التعامل مع المدفوعات على الفور لأن التحديثات خارج السلسلة بين طرفين لا تتطلب وقتًا إضافيًا لمعالجتها والتحقق منها بواسطة شبكة blockchain.
- ثانيًا، تحمل المدفوعات رسومًا أقل لأننا نحتاج فقط إلى التعامل على السلسلة عندما نفتح قناة الدولة ونغلقها. هذا يعني أن معظم المعاملات تتم خارج السلسلة برسوم أقل بكثير.

إذن، لماذا لا يكون هذا هو الحل النهائي؟ حسنًا، هناك حدود لما يمكن أن تفعله State Channels.

على سبيل المثال، لا يمكننا استخدام قنوات الدولة للتعامل مع أشخاص ليسوا جزءًا من قناة الدولة. نحن مقيدون أيضًا بأنواع تحديثات الحالة الممكنة في قناة الحالة. لا يمكن استخدام تطبيق معقد مثل Uniswap في قناة حكومية لأنه عندما نتبادل رمزين مميزين على Uniswap، تنفذ العقود الذكية تلقائيًا مجموعة من الخطوات الوسيطة لإجراء المبادلة. لا تحتوي هذه الخطوات على مستخدم مصرح له بتسجيل الخروج على كل منها.

الجانب السلبي الآخر لقنوات الدولة هو أنها تتطلب منا حجز السيولة لإنشاء القناة والحماية من الحالات التي قد لا يدفع فيها الطرف المضاد الخبيث الأموال الموعودة. قد يكون هذا جيدًا لقناة واحدة، ولكن عندما نحاول توجيه المدفوعات عبر شبكة من قنوات الدولة، فإن السيولة المحبوسة في القنوات الوسيطة تجعلها "غير فعالة في رأس المال".

أخيرًا، تتطلب قنوات الدولة شخصًا يمكنه مشاهدة الشبكة بشكل دوري (أو تفويض هذه المسؤولية إلى شخص آخر). هذا يضمن أمان أموالك، مما يضيف طبقة أخرى من التعقيد وعدم الكفاءة.

بشكل عام، تعمل القنوات الحكومية بشكل جيد في حالات الاستخدامات التي يحتاج فيها طرفان إلى التعامل مع بعضهما البعض بسرعة وبتكلفة زهيدة وعلى مدار فترة زمنية(مثل التاجر والعميل). ولكن نظرًا لحالات الاستخدام المحدودة وعدم كفاءة رأس المال، فإننا لا نراهن على أن قنوات الدولة هي الحل النهائي لتوسيع نطاق Ethereum.

### سلاسل جانبية “Side Chains”

كانت سلاسل Sidechains موجودة أيضًا لفترة طويلة، ومن السهل جدًا فهمها. باختصار، السلسلة الجانبية عبارة عن blockchain مستقل "مرتبط" بـ blockchain الرئيسي.

عندما نقوم "بربط" بلوكشين بأخرى، فهذا يعني أنه يمكننا نقل الأصول بين هذين البلوكشين. الربط "أحادي الاتجاه" هو المكان الذي ننقل فيه الأصول من blockchain الرئيسي إلى السلسلة الجانبية، ولكن ليس العكس. يعمل هذا عن طريق "نسخ" الرموز المميزة الموجودة على blockchain الرئيسي عن طريق إرسالها إلى عنوان غير قابل للإنفاق - ثم "mint" الرموز المميزة المكافئة على السلسلة الجانبية.

<img src="https://www.web3arabs.com/courses/layers/sidechains1.png" alt="Sidechains 1"/>

إذاً، "الربط ثنائي الاتجاه" هو الوقت الذي يمكننا فيه نقل الأصول من وإلى سلسلة blockchain الرئيسية والسلسلة الجانبية. يتطلب هذا "قفل" الرموز المميزة الخاصة بنا على السلسلة الرئيسية ثم "سك" كمية مكافئة من الرموز المميزة على السلسلة الجانبية. عندما نريد التحويل مرة أخرى إلى الرمز الأصلي ، فإننا "نحرق" الرموز المميزة الموجودة على السلسلة الجانبية ثم نفتح الرموز المميزة على السلسلة الرئيسية.

<img src="https://www.web3arabs.com/courses/layers/sidechains2.png" alt="Sidechains 2"/>

لذلك، فإن السلسلة الجانبية هي عندما نقوم بإنشاء blockchain جديد مرتبط باتجاهين مع blockchain الرئيسي. عندما نريد معاملات أسرع، يمكننا نقل أموالنا من السلسلة الرئيسية إلى السلسلة الجانبية وإجراء المعاملات هناك. عندما ننتهي، نعيد أموالنا إلى السلسلة الرئيسية.

<img src="https://www.web3arabs.com/courses/layers/sidechains3.png" alt="Sidechains 3"/>

مثال على السلسلة الجانبية لـ Bitcoin هو Liquid Network. الشبكة السائلة مرتبطة ببيتكوين وتسمح بمدفوعات بيتكوين أسرع وأرخص. مثال آخر شائع هو Polygon، وهو عبارة عن سلسلة جانبية مرتبطة بـ Ethereum.

عندما يريد المستخدمون معاملات أسرع، يمكنهم قفل بعض ETH وإنشاء كمية مكافئة من رمز Matic على سلسلة Polygon الجانبية. على سلسلة Polygon الجانبية، يمكنهم الاستمتاع بمعاملات أسرع وأرخص. عند الانتهاء من المعاملات، يمكنهم تحويل رمز Matic الخاص بهم مرة أخرى إلى ETH.

<img src="https://www.web3arabs.com/courses/layers/sidechains4.png" alt="Sidechains 4"/>

> ملاحظة: من الناحية الفنية، Matic ليس سلسلة جانبية لأنه يلتزم بشكل دوري بحالة السلسلة الجانبية إلى Ethereum. ومن ثم، فإنهم يحبون أن يطلقوا على أنفسهم "سلسلة الالتزام".
> <img src="https://www.web3arabs.com/courses/layers/sidechains5.png" alt="Sidechains 5"/>

بشكل عام، تكون السلاسل الجانبية قابلة للتطوير لأنها عادةً ما تقوم بمقايضة في اللامركزية و/أو الأمان باستخدام خوارزمية إجماع مختلفة تسمح بقابلية التوسع.

تعد Sidechains حلاً جيدًا لسد الفجوة للكم الهائل من الازدحام على شبكة Ethereum، لكن Ethereum لا تراهن على أن هذا هو الحل النهائي للتوسع أيضًا. سيصبح السبب واضحًا مع استمرار القراءة :)

### بلازما “Plasma”

البلازما هو حل آخر من "الطبقة 2" يتيح لنا نقل المعاملات خارج الطبقة الأساسية. قبل أن نصل إلى البلازما، من المهم أن نلاحظ أنه كان هناك العديد من التكرارات للبلازما بمرور الوقت، ولكل منها مفاضلاتها الخاصة. يمكنك التحقق من خريطة العالم للبلازما، والتي تسرد العديد من أنواع التصاميم المختلفة التي حاول الناس إنشاءها لحل التحديات التي تأتي مع البلازما. هناك الكثير!

بالطبع، لغرض هذا المنشور، سأضطر إلى تعميم مفهوم البلازما دون التركيز كثيرًا على التطبيقات الفردية. إذا كنت تريد التعمق أكثر، تحقق بالتأكيد من خريطة العالم.

إذاً، ما هي البلازما؟ البلازما هي في الأساس سلسلة من العقود الذكية (أو "سلاسل البلازما") التي تعمل خارج سلسلة الكتل الرئيسية.
<img src="https://www.web3arabs.com/courses/layers/plasma1.png" alt="Plasma 1"/>

سلاسل البلازما تشبه فروع الشجرة ، حيث يمثل Ethereum الجذع وكل سلسلة بلازما عبارة عن فرع. يتم التعامل مع كل فرع على أنه blockchain له تاريخ وحسابات blockchain الخاصة به.

تفرض "blockchain الجذرية" (أي Ethereum blockchain) صلاحية الحالة في سلاسل البلازما باستخدام شيء يسمى "إثباتات الاحتيال". أدلة الاحتيال هي آلية نقدم من خلالها بعض البيانات، ويمكن لأي شخص تحديد ما إذا كانت البيانات غير صالحة باستخدام البراهين الرياضية.

<img src="https://www.web3arabs.com/courses/layers/plasma2.png" alt="Plasma 2"/>

لا يحتاج كل بلوكشين بلازما إلى نشر بيانات المعاملات على سلسلة الجذر. بدلاً من ذلك، كل سلسلة بلازما لها "مشغل". يمكن أن يكون هذا ممثلًا مركزيًا، أو مجموعة متعددة المهام تمثل عدة أشخاص، أو حتى لجنة تشارك في أن تكون مشغلًا. يقدم مشغل سلسلة البلازما جذر Merkle لعمليات النقل التي حدثت في سلسلة البلازما.

ملاحظة: إذا كنت لا تعرف كيفية عمل أشجار Merkle، فأنا أوصي بشدة بقراءة <a href="https://media.consensys.net/ever-wonder-how-merkle-trees-work-c2f8b7100ed3" target="_blank">هذا الشرح</a> قبل الانتقال.

على مستوى عالٍ، تتيح لنا شجرة Merkle أخذ مجموعة كبيرة من البيانات (مثل المعاملات في كتلة) وإنشاء تجزئة جذر واحدة تمثل مجموعة البيانات بأكملها.

<img src="https://www.web3arabs.com/courses/layers/plasma3.png" alt="Plasma 3"/>

في وقت لاحق، يمكننا بسهولة إثبات وجود جزء من البيانات من مجموعة البيانات الكبيرة (أي معاملة واحدة من مجموعة من المعاملات) في مجموعة البيانات هذه من خلال توفير الفرع المؤدي إلى تلك القطعة من البيانات.

<img src="https://www.web3arabs.com/courses/layers/plasma4.png" alt="Plasma 4"/>

إذا حاول شخص ما إثبات وجود معاملة احتيالية، فلن تتطابق التجزئة وسنعرف ذلك على الفور.

<img src="https://www.web3arabs.com/courses/layers/plasma5.png" alt="Plasma 5"/>

حسنًا، نعود إلى البلازما.

تقدم كل سلسلة بلازما جذر Merkle لعمليات النقل التي تحدث عليها. عندما يحاول المستخدم لاحقًا نقل أصوله من سلسلة البلازما إلى سلسلة الجذر، يمكن للمستخدم إرسال فرع Merkle لأحدث معاملة لإرسال الأصل إليه (أحدث معاملة كافية لنا لمعرفة الرصيد الحالي على سلسلة البلازما). يبدأ هذا فترة تحدي حيث يمكن لأي شخص محاولة إثبات أن فرع Merkle الخاص بالمستخدم احتيالي. إذا كان فرع Merkle احتياليًا، فيمكن تقديم إثبات الاحتيال.

نظرًا لأن blockchain الجذر يتتبع فقط جذور Merkle، فإنه يتعين عليه معالجة بيانات أقل بكثير مما لو حدثت هذه المعاملات على mainchain. هذا يقلل بشكل كبير من كمية البيانات المخزنة على blockchain الجذر ويتيح لنا توسيع نطاق سلسلة الجذر.

علاوة على ذلك، إذا كان هناك هجوم خبيث على سلسلة بلازما معينة، فيمكن للناس القيام بـ " خروج جماعي " من سلسلة الأطفال الفاسدة.

<img src="https://www.web3arabs.com/courses/layers/plasma6.png" alt="Plasma 6"/>

<img src="https://www.web3arabs.com/courses/layers/plasma7.png" alt="Plasma 7"/>

تعد سلاسل البلازما أكثر ملاءمة من قنوات الدولة لأنه يمكنك إرسال أصول إلى أي شخص، بينما مع قنوات الدولة، يمكنك التعامل فقط مع الأشخاص في قناة الدولة. علاوة على ذلك، فإن فائدة سلاسل البلازما على السلاسل الجانبية هي أن سلسلة البلازما مؤمنة بواسطة Ethereum.

الفرق الأساسي بين الاثنين (البلازما مقابل السلسلة الجانبية) هو أن السلسلة الجانبية لها نموذج الأمان الخاص بها. لديهم آلية إجماع خاصة بهم ومجموعة منفصلة من العقد التي تتحقق من صحة الدولة. حتى إذا تعرضت السلسلة الجانبية للهجوم، فلن يحدث شيء للسلسلة الرئيسية، والعكس صحيح. إذا حدث هجوم على السلسلة الجانبية، فلن تستطيع mainchain فعل أي شيء لحماية المستخدمين.

من ناحية أخرى، تتمتع سلاسل البلازما بنموذج أمان معتمد. يمكن لكل سلسلة بلازما استخدام آليتها الخاصة للتحقق من صحة المعاملات، لكنها لا تزال تستخدم سلسلة بلوكشين Ethereum كحكم نهائي للحقيقة. في حالة الهجمات البيزنطية، يمكن لمستخدمي سلسلة البلازما الخروج إلى Ethereum.

لكن البلازما لها العديد من الجوانب السلبية التي تجعلها حلاً باهتًا لقابلية التوسع.

أولاً، عندما يريد المستخدمون نقل أصولهم من عقود Plasma إلى سلسلة Ethereum blockchain الرئيسية، عليهم الانتظار سبعة أيام. يعد هذا وقتًا كافيًا للأشخاص للتحقق من أن معاملة السحب ليست احتيالية. إذا كان الأمر كذلك، فيمكنهم إنشاء دليل على الاحتيال باستخدام شجرة Merkle في سلسلة البلازما.

ثانيًا، تتطلب كل سلسلة Plasma من المشغل نشر التزامات جذر Merkle إلى السلسلة الرئيسية. هذا يتطلب منا الاعتماد على طرف ثالث لنشر التزامات جذر Merkle بدقة على السلسلة. لسوء الحظ، يمكن للمشغلين تنفيذ ما يُعرف باسم هجوم توفر البيانات "data availability attack" حيث يمنعون نشر معاملات معينة على السلسلة الرئيسية لأسباب خبيثة.
<img src="https://www.web3arabs.com/courses/layers/plasma8.png" alt="Plasma 8"/>

في هذه الحالة، يمكن للمشغلين إقناع الشبكة بقبول الكتل غير الصالحة، ولا توجد طريقة لإثبات بطلانها. هذا يمنع المستخدمين الآخرين من معرفة الحالة الدقيقة لـ blockchain. يمنع هذا أيضًا الأشخاص من إنشاء الكتل أو المعاملات لأنهم يفتقرون إلى المعلومات اللازمة لإنشاء البراهين. لا يمكن عزو هجمات توفر البيانات بشكل فريد، على عكس الاحتيال. ليس لدينا طريقة لمعرفة وقوع الهجوم.

يمكن أن يكون المشغل ضارًا بطرق أكثر وضوحًا أيضًا، مثل تقديم معاملات احتيالية. في هذه الحالة، يمكن للأشخاص إجراء عمليات خروج جماعية "mass exits" كما هو موضح أعلاه. ولكن ثبت أن تنفيذها أصعب بكثير من الناحية العملية. إذا أراد العديد من المستخدمين الخروج الجماعي، فقد يؤدي ذلك إلى ازدحام على mainchain، وقد لا يتمكن المستخدمون من الخروج في الوقت المناسب، مما يتسبب في فقدهم لأموالهم.

ثالثًا ، تتطلب البلازما حضور أصحاب الأصول المتعاملة. هذا يضمن سلامة سلسلة البلازما لأنه يجعل من المستحيل التعامل دون موافقة المالك (مثل إرسال رموز ERC 20 إلى عنوان معتمد). تعمل البلازما بشكل أفضل في عمليات النقل البسيطة، ولكن مع زيادة تعقيد المعاملات، تصبح مساحة التصميم جامحة.

للأسباب المذكورة أعلاه، اتبعت شبكتا Polygon و OMG في البداية معماريات البلازما من أجل التوسع ولكنهما ابتعدتا منذ ذلك الحين.

وفي هذا السياق، بعد اقتراح حلول مختلفة، حصلنا على تجميعات.

### التراكمية “Rollups”

تمامًا مثل قنوات الحالة، والسلاسل الجانبية، وسلاسل البلازما، فإن الالتفافات هي حل "Layer 2". في الواقع، تتشابه المجموعات التراكمية إلى حد كبير مع البلازما من حيث أننا نجمع المعاملات خارج السلسلة وننشر تحديثًا على blockchain الرئيسي. ومع ذلك، فإن الاختلاف الرئيسي هو أنه مع التجميعات، نقوم أيضًا بنشر بيانات المعاملات لكل دفعة من المعاملات على السلسلة. باستخدام Plasma، نقوم فقط بنشر جذور Merkle.

بعبارة أخرى ، مع التجميعات ، نقوم بمعالجة المعاملات خارج السلسلة، لكننا ننشر بيانات المعاملات على السلسلة. كمية البيانات التي ننشرها على السلسلة هي الحد الأدنى للمبلغ المطلوب للتحقق محليًا من معاملة التجميع. من خلال وضع البيانات في السلسلة، أي شخص يمكنه اكتشاف الاحتيال أو بدء عمليات السحب أو البدء شخصيًا في إنتاج دفعات المعاملات. لذلك، تمنحنا التراكمية ضمانات أمان أعلى بكثير من سلاسل البلازما أو Sidechains.

الاختلاف الرئيسي الآخر بين التراكمية والبلازما هو أنه لا داعي للقلق بشأن مشكلات توفر البيانات. بعد كل شيء، نحن ننشر بيانات المعاملات على mainchain. هذا فوز كبير.

باستخدام Rollups، نحن نشغل بشكل فعال نسخة من EVM داخل طبقة الالتفاف. هذا يعني أنه من الممكن تنفيذ أي معاملة ممكنة على Ethereum في مجموعة التحديثات.

وهذا يطرح السؤال التالي: إذا كنا لا نزال ننشر بيانات المعاملات على السلسلة، فكيف تعمل طبقة المقياس 1 هذه؟ ألا تزال قابلية التوسع تقتصر على النطاق الترددي للبيانات في السلسلة الرئيسية؟

نعم إنه كذلك. المفتاح هنا هو أننا نحصل على قابلية التوسع من 5x إلى 100x مع التجميعات، ولكن ليس قابلية التوسع اللانهائية. تستخدم Rollups أيضًا الكثير من حيل الضغط الرائعة لتقليل بيانات المعاملات التي ننشرها على السلسلة، لذلك يكون تخزين البيانات على السلسلة أقل بكثير مما يمكن أن يكون هناك خلاف ذلك.
<img src="https://www.web3arabs.com/courses/layers/rollups1.png" alt="Rollups 1"/>

وفي الوقت نفسه، نقوم بالاستعانة بمصادر خارجية لجميع عمليات الرفع الثقيل لتنفيذ المعاملات خارج السلسلة إلى مجموعة التحديثات. تذكر أنه أثناء تنفيذ المعاملة، يجب معالجة المعاملة بواسطة Ethereum Virtual Machine (EVM) والتفاعل مع الحالة (مثل التخزين وأرصدة الحسابات وما إلى ذلك). هذا مكلف.

ومع ذلك، مع التجميعات، ننقل هذا التنفيذ إلى طبقة التجميع عن طريق تشغيل إصدار من EVM في القوائم - لذلك ما زلنا نقوم بنفس التنفيذ، لكن تكاليف الغاز على طبقة التجميع أرخص بكثير من Ethereum.

### نظرة فاحصة على التراكمية
الآن، دعنا نلقي نظرة على كيفية عمل الـ Rollups تحت الغطاء.

هناك "عقد تراكمي" على mainchain يحافظ على الحالة الحالية لطبقة التجميع. ويشمل ذلك أرصدة حسابات المستخدمين المتعاملين عليها ورمز العقد الذكي للعقود التي تسري فيه. باختصار، يتتبع عقد التجميع "جذر الحالة" للمعاملات في طبقة التجميع.

<img src="https://www.web3arabs.com/courses/layers/look-rollups1.png" alt="Look Rollups 1"/>

يتكون "جذر الحالة" من خريطة قيمة مفتاح حيث تكون المفاتيح عناوين والقيم حسابات. يحتوي كل حساب على ما يصل إلى 4 خصائص: الرصيد، والرمز nonce، والرمز (فقط للعقود الذكية)، والتخزين (فقط للعقود الذكية).  

<img src="https://www.web3arabs.com/courses/layers/look-rollups2.png" alt="Look Rollups 2"/>

عندما تحدث المعاملات على طبقة التجميع، يحدث تغيير في الحالة. بالطبع، هذا يعني أن جذر الحالة يحتاج إلى التحديث أيضًا. ولكن بدلاً من تحديث جذر الحالة لكل معاملة، يتم "تجميع" المعاملات وإرسالها إلى عقد التجميع على السلسلة الرئيسية. ستتضمن الدفعة نموذجًا مضغوطًا لمجموعة المعاملات وجذر حالة محدث يمثل البيانات بعد معالجة مجموعة المعاملات.

يتحقق عقد التجميع على mainchain من أن جذر الحالة السابقة في الدُفعة يطابق جذر الحالة الحالي - إذا كان كذلك، فإنه يقوم بتبديل جذر الحالة إلى جذر الحالة الجديد.

<img src="https://www.web3arabs.com/courses/layers/look-rollups3.png" alt="Look Rollups 3"/>

نظرًا لأن بيانات المعاملات المنشورة لا يتم تفسيرها فعليًا بواسطة EVM، فإننا لا نقوم بالوصول إليها أو نكتبها - سيكون ذلك مكلفًا للغاية. بدلاً من ذلك، نقوم بترحيل بيانات المعاملة المضغوطة كمعامل "calldata" إلى عقد التجميع.

إليكم سبب ذلك. في Solidity، تعد calldata أرخص أشكال التخزين للاستخدام. في الواقع، لا يتم تخزين الحجج التي تم تمريرها كمعامل calldata في حالة Ethereum على الإطلاق، مما يعني أننا نتجنب الكثير من رسوم الغاز. وفي الوقت نفسه، لا يزال بإمكان عقد Ethereum تخزين بيانات المعاملة عند إنشاء الكتلة (في السجلات التاريخية).

قد يتساءل القراء المتمرسون عن الفرق بين البلازما والتراكم. ها هي الفجوة الرئيسية: من خلال التجميعات، نقوم بنشر بيانات المعاملة على السلسلة جنبًا إلى جنب مع جذر الحالة. باستخدام البلازما، نقوم فقط بنشر جذر الحالة للمعاملات.

على عكس Plasma، حيث لدينا عامل يقوم بنشر جذر Merkle في سلسلة الجذر ، تتيح المجموعات التجميعية لأي شخص نشر الدفعة الجديدة من المعاملات إلى عقد التجميع على السلسلة ، حيث سنستكشف بمزيد من العمق لاحقًا.

مرة أخرى، هذا يطرح السؤال: نظرًا لأننا ننشر فقط بيانات المعاملة إلى mainchain ولا ننفذ المعاملات على السلسلة، فكيف نعرف أن بيانات المعاملة وجذر الحالة المنشور على mainchain ليست احتيالية؟

أدخل: مجموعات متفائلة وتجميعات ZK، لكل منها طريقتها الخاصة في التعامل والتحقق من صحة الدفعات.

### التراكمية المتفائلة “Optimistic Rollups”

يمكنك على الأرجح تخمين ما هي التراكمية المتفائلة التي تستند إلى الاسم. عندما يتم "تجميع" دفعة جديدة من المعاملات إلى السلسلة الرئيسية، يتم ترحيل جذر الحالة وتجزئة كل دفعة، لكننا لا نتحقق من صحة تنفيذ المعاملات بشكل صحيح، على الأقل ليس في وقت الترحيل.

بهذه الطريقة، ننشر "بتفاؤل" جذر الحالة الجديد وبيانات المعاملات إلى عقد التجميع على mainchain. عندما يتم نشر جذر حالة جديد على mainchain من قبل شخص ما، فإن العقد الذكي للتجميع ببساطة يأخذ كلمتهم من أجله.

إذا اكتشف شخص ما أنه تم نشر انتقال حالة غير صالح إلى عقد التجميع الذكي، فيمكنه إنشاء "دليل على الاحتيال".

يشمل إثبات الغش ما يلي:

- إثبات "حالة pre-state" أو كيف بدت الأمور قبل تطبيق المعاملة
- إثبات "ما بعد post-state" أو كيف كان ينبغي للدولة أن تعتني بالمعاملة
- دليل على المعاملات التي تم تطبيقها أثناء انتقال الحالة

سير العمل واضح ومباشر: يتم نشر دليل إثبات الاحتيال هذا في عقد التجميع على السلسلة الرئيسية. ثم يتحقق عقد التجميع من الإثبات ويطبق منطق المعاملة على الحالة المسبقة. ثم يقارن النتيجة بحالة ما بعد الدولة. إذا كان هناك عدم تطابق، فهذا يثبت أن من قام بنشر الدفعة لم يطبق المعاملات بشكل صحيح. ثم يقوم العقد الذكي بإرجاع تلك المجموعة من المعاملات وجميع الدفعات التي تليها.

تحقيقًا لهذه الغاية، يتعين على أي شخص يرسل دفعات إلى السلسلة الرئيسية إيداع وديعة، لذلك إذا تصرفوا بشكل ضار وتم القبض عليهم، فيمكن "قطعهم".

### مجموعات ZK

إذا استخدمت التراكمية المتفائلة عقلية "الأبرياء حتى تثبت إدانته"، فإن ZK Rollups تستخدم عقلية "لا تثق، وتحقق".

مع مجموعات ZK، تشتمل كل دفعة على إثبات تشفير يسمى ZK-SNARK يثبت أن جذر الحالة هو النتيجة الصحيحة لتنفيذ مجموعة المعاملات. إثبات ZK-SNARK عبارة عن تجزئة تمثل تغيير حالة blockchain بعد تنفيذ المعاملات في طبقة zk-rollup. يتم نشر إثبات الصلاحية هذا في عقد التجميع، بحيث يمكن لأي شخص استخدامه للتحقق من المعاملات في دفعة معينة على طبقة التجميع.

يكمن السحر هنا في كيفية عمل ZK-SNARKs. لقد سمحوا لنا بإنشاء دليل على جزء أساسي من البيانات دون الكشف عن البيانات. يمكن لأي شخص فيما بعد التحقق من وجود البيانات، حتى لو لم يكن لديه حق الوصول إلى البيانات نفسها.

الأساس الرياضي لـ ZK-SNARKS معقد ويتجاوز نطاقنا، ولكن إذا كنت مهتمًا بالفضول، فأنا أشجعك على القفز على Google أو YouTube وقضاء بعض الوقت في فهم كيفية عملهما.

## الفرق بين ZK و Optimistic

للوهلة الأولى، تبدو عمليات طرح ZK أفضل في كل شيء من عمليات التشكيل المتفائلة. بعد كل شيء، يمكن التحقق من المعاملات تلقائيًا، دون الحاجة إلى المنافسين، ويثبت المهاجمون معاملاتهم الخاصة قبل تقديمها. علاوة على ذلك، يدفعون الغاز لمعالجة الدليل في العقد الذكي، لذلك يخسرون فقط إذا قدموا دليلاً غير صالح.

لذا، لماذا لديك عمليات طرح متفائلة على الإطلاق؟

المشكلة مع عمليات طرح ZK هي أنه من الصعب بناء هذه البراهين، من الناحية الرياضية. تتطلب كل حالة استخدام وقتًا للبحث للعثور على دليل تشفير مطابق، والذي قد يستغرق وقتًا طويلاً للعثور عليه.

علاوة على ذلك، غالبًا ما تكون أدلة ZK معقدة وبالتالي مكلفة للتحقق. كلما زاد عدد العمليات التي يحتوي عليها العقد الذكي، زادت تكلفة تشغيله. بالإضافة إلى ذلك، فإن العقود الذكية محدودة أيضًا في الفضاء، لذلك يجب أن يعمل الدليل في أقل من عدد معين من العمليات.

### سلاسل الفالديوم “Validium Chains”

يعمل Validium بشكل مشابه جدًا لعمليات طرح ZK باستثناء تخزين البيانات خارج السلسلة الرئيسية. نظرًا لعدم نشر بيانات المعاملات على السلسلة الرئيسية، فإن هذا يقدم افتراضات ثقة جديدة حيث يجب على المستخدمين الوثوق بمشغل لإتاحة البيانات عند الحاجة. يتم تحقيق ذلك عادةً من خلال لجنة من الكيانات المعروفة التي تشترك في سمعتها التجارية على كونها مزود بيانات موثوق به. إذا توقف مشغل العقدة L2 عن خدمة طلبات السحب، فستجعل هذه اللجنة نسختها من البيانات متاحة للجمهور.

من المهم ملاحظة أن Validium هو نوع من حالات توفر البيانات، ولا يهتم بكيفية تنفيذ المعاملات. عادةً ما يمكنك استخدام نهج Validium مع تنفيذ المعاملات المستند إلى ZKR.

### سلاسل الإرادة “Volition Chains”

سلاسل الإرادة هي تلك التي هي من مواليد Rollups و Validium نهج توفر البيانات. بشكل أساسي، تسمح بسيناريو هجين لتوافر البيانات حيث يمكن للمستخدمين تحديد ما يريدون في السلسلة الرئيسية وما لا يريدونه في السلسلة الرئيسية.

على سبيل المثال، قد لا ترغب شركة تجارية كبيرة في أن تكون كل صفقة تقوم بها متاحة للجمهور على السلسلة الرئيسية, ولكن في نهاية الأسبوع، يجب نشر دليل على السلسلة الرئيسية ليرث فوائده الأمنية. حتى يتمكنوا من تخزين البيانات خارج السلسلة لكل معاملة فردية، ولكن جلبها على السلسلة من أجل الربح/الخسارة وتغيرات الرصيد في الأسبوع بشكل عام.

مرة أخرى، على غرار Validiums، هذه مجرد حالة توفر البيانات، ولا تهتم بكيفية تنفيذ المعاملات. عادة، يمكنك استخدام نهج Volition مع ZKR.

## ترقية شبكة ETH و Layer 2

يجب أن ننظر إلى ما تجلبه ترقية ETH إلى الطاولة، ولماذا تفيد الطبقة 2.

تعمل ETH حاليًا كـ "كمبيوتر عالمي" واحد وموزع. يتم تنفيذ جميع المعاملات بشكل تسلسلي وهناك حالة مشتركة واحدة يتم الاحتفاظ بها بين جميع عقد Ethereum. هذا له مزاياه، ولكن العيب هو أنه عندما يرغب الكثير من المستخدمين في التعامل بشكل متوازي، يمكن أن ترتفع رسوم الغاز مما قد يجعل المعاملات باهظة الثمن. في الآونة الأخيرة، أدى الطلب على Ethereum dApps إلى رسوم غاز عالية نسبيًا. يمكنك أن تجادل في مزايا الأمن واللامركزية على التكلفة طوال اليوم، ولكن لا يزال استخدام الوافد الجديد العادي مكلفًا.

تساعد حلول الطبقة 2، مثل عمليات الطرح، في تخفيف التكلفة من خلال تنفيذ المعاملات خارج السلسلة الرئيسية. بدلاً من ذلك، يقومون بالحساب على الطبقة 2، ثم ينشرون دليل تشفير إلى السلسلة الرئيسية التي يمكن لأي شخص التحقق منها. نظرًا لأنه يمكن لأي شخص التحقق مما إذا كان الدليل الذي تم نشره صالحًا أم غير صالح أم لا، فقد يشعر بالراحة في معرفة ما إذا تم تنفيذ المعاملة بشكل صحيح أو غير صحيح. بسبب هذه الخاصية، ترث عمليات التدحرج الفوائد الأمنية للسلسلة الرئيسية دون الحاجة إلى دفع رسوم الغاز للحساب والتنفيذ على السلسلة الرئيسية.

مع ترقية ETH، تركز ETH على تمكين تجاهل البيانات. وهذا يعني بشكل أساسي أنه سيتم تقسيم الحالة الوحيدة للشبكة إلى مجموعات أصغر من البيانات تسمى الشظايا, والهدف هو تقليل تكاليف التخزين عن طريق جعل التخزين أكثر سهولة للشبكة. نتيجة القيام بذلك هي أنه عندما تقوم عمليات التدحرج بنشر البراهين إلى السلسلة الرئيسية، سيكون من الأرخص أن يتم ذلك.

تكاليف الغاز في سلاسل التدحرج محدودة حاليًا بتكاليف تخزين الغاز في السلسلة الرئيسية. على الرغم من أن الحساب على الطبقة 2 رخيص جدًا، إلا أن نشر البراهين على السلسلة الرئيسية لا يزال يتطلب دفع الغاز على Ethereum لتخزين الدليل. إذا انخفضت تكاليف التخزين على Ethereum، فإن تكلفة استخدام سلاسل التدحرج تنخفض أيضًا حيث يمكن نشر البراهين بسعر أرخص. سيؤدي ذلك إلى تحفيز المزيد من الأشخاص على استخدام سلاسل الطبقة 2، وسيتراجع الطلب المباشر على تخزين بيانات Ethereum، مما سيقلل من تكاليف التخزين على Ethereum أكثر، وما إلى ذلك.

لذلك، ستساعد ترقية ETH في الواقع على تأمين حلول الطبقة 2 للحصول على الاعتماد وتصبح أرخص في الاستخدام.

كما هو الحال دائمًا، إذا كانت لديك أي أسئلة أو شعرت بالتعثر أو أردت فقط أن تقول مرحبًا، فقم بالإنضمام على <a href="https://discord.gg/ykgUvqMc4Q" target="_blank">Discord</a> وسنكون أكثر من سعداء لمساعدتك!
